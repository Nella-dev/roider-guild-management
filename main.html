<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AFK Journey: Homestead ROIDER Guild Management</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>

  <style>
    :root {
      --bg: #0f1015;
      --card: #1c1f2a;
      --accent: #f4c430;
      --text: #e6e6e6;
    }

    body {
      margin: 0;
      font-family: Pretendard, system-ui, sans-serif;
      background: radial-gradient(circle at top, #1b2333, #0f1015 60%);
      color: var(--text);
      min-height: 100vh;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 20px;
      background: linear-gradient(135deg, #1f2933, #121721);
      border-bottom: 1px solid #2a3242;
    }

    .logo {
      font-weight: 900;
      letter-spacing: 0.5px;
      color: var(--accent);
      text-shadow: 0 0 10px rgba(244,196,48,0.3);
    }

    .user-box {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      color: #ccc;
    }

    .user-box img {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid #444;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 40px 20px;
      text-align: center;
    }

    .hero {
      margin-top: 40px;
      margin-bottom: 30px;
    }

    .hero h1 {
      font-size: 2rem;
      margin-bottom: 12px;
      color: var(--accent);
    }

    .hero p {
      opacity: 0.8;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 16px;
      margin-top: 40px;
    }

    .menu-card {
      background: linear-gradient(180deg, #1f2736, #161b26);
      border: 1px solid #2a3242;
      border-radius: 14px;
      padding: 24px 10px;
      cursor: pointer;
      transition: 0.25s;
      box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    }

    .menu-card:hover {
      transform: translateY(-6px) scale(1.02);
      border-color: var(--accent);
      box-shadow: 0 10px 30px rgba(244,196,48,0.25);
    }

    .menu-card span {
      display: block;
      font-size: 28px;
      margin-bottom: 8px;
    }

    .footer {
      margin-top: 60px;
      text-align: center;
      font-size: 12px;
      opacity: 0.5;
    }

    button.logout {
      background: transparent;
      border: 1px solid #555;
      color: #ccc;
      border-radius: 20px;
      padding: 6px 14px;
      cursor: pointer;
    }

    button.logout:hover {
      border-color: var(--accent);
      color: var(--accent);
    }
  </style>
</head>
<body>

  <header>
    <div class="logo" id="appTitle">ROIDER</div>
    <div class="user-box">
      <img id="userPhoto"
     src="https://api.dicebear.com/7.x/bottts/svg?seed=roider"
     alt="profile" />
      <span id="userName">Loading...</span>
      <button class="logout" onclick="logout()">Logout</button>
    </div>
  </header>

  <div class="container">
    <div class="hero">
      <h1 id="heroTitle">AFK Journey: Homestead ROIDER Guild Management</h1>
      <p id="heroDesc">Guild Operation & Weekly Management System</p>
    </div>

    <div class="menu-grid">
      <div class="menu-card" onclick="go('notice.html')">
        <span>ğŸ“¢</span> ê³µì§€
      </div>
      <div class="menu-card" onclick="go('members.html')">
        <span>ğŸ‘¥</span> ê¸¸ë“œì›
      </div>
      <div class="menu-card" onclick="go('attendance.html')">
        <span>ğŸ“…</span> ì¶œì„ë¶€
      </div>
      <div class="menu-card" onclick="go('weekly.html')">
        <span>ğŸ†</span> ì£¼ê°„ê²°ì‚°
      </div>
      <div class="menu-card" onclick="go('war.html')">
        <span>âš”ï¸</span> ëŒ€í•­ì „
      </div>
    </div>

    <div class="footer">
      AFK Journey Fanmade Tool Â· ROIDER Guild
    </div>
  </div>

<script>
  // Firebase ì„¤ì • (ê¸°ì¡´ ê·¸ëŒ€ë¡œ)
  const firebaseConfig = {
    apiKey: "AIzaSyCbqEcGsdSDBZs8PjiI05YRNEGupLf3nSc",
    authDomain: "roider-guild-management.firebaseapp.com",
    projectId: "roider-guild-management",
    storageBucket: "roider-guild-management.firebasestorage.app",
    messagingSenderId: "1012249034459",
    appId: "1:1012249034459:web:ec0f821f29170446af96fe",
    measurementId: "G-J7W4LFLHPP"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // DOM ì¤€ë¹„ ë³´ì¥
  window.addEventListener("DOMContentLoaded", () => {

    aauth.onAuthStateChanged(async (user) => {
  const nameEl = document.getElementById("userName");
  const photoEl = document.getElementById("userPhoto");

  if (!user) {
    location.replace("login.html");
    return;
  }

  // ê¸°ë³¸ UI (ê¹œë¹¡ì„ ë°©ì§€)
  nameEl.textContent = "Loading...";
  photoEl.src = "https://api.dicebear.com/7.x/bottts/svg?seed=roider";

  // ğŸ”§ Firestoreì—ì„œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° (users ì»¬ë ‰ì…˜)
  const docRef = db.collection("users").doc(user.uid);
  const docSnap = await docRef.get();

  // ë‹‰ë„¤ì„ ë“±ë¡ ì•ˆ í–ˆìœ¼ë©´ ë‹‰ë„¤ì„ ì„¤ì • í˜ì´ì§€ë¡œ
  if (!docSnap.exists) {
    location.replace("nickname.html");
    return;
  }

  const data = docSnap.data();

  // ğŸ”¥ ìŠ¹ì¸ ì•ˆ ëìœ¼ë©´ ë©”ì¸ UI ë³´ì—¬ì£¼ì§€ ë§ê³  ë°”ë¡œ pendingìœ¼ë¡œ
  if (data.role !== "approved") {
    location.replace("pending.html");
    return;
  }

  // âœ… ì—¬ê¸°ê¹Œì§€ ì™”ìœ¼ë©´ "ìŠ¹ì¸ëœ ì‚¬ìš©ì"ë§Œ ë©”ì¸ ì ‘ê·¼ í—ˆìš©

  // ë‹‰ë„¤ì„ í‘œì‹œ (Firestore â†’ localStorage ë™ê¸°í™”)
  const nickname = data.nickname;
  nameEl.textContent = nickname || user.displayName || user.email || "User";
  if (nickname) {
    localStorage.setItem("nickname", nickname);
  }

  // í”„ë¡œí•„ ì´ë¯¸ì§€
  if (user.photoURL) {
    photoEl.src = user.photoURL;
  }
});

  });
</script>

</body>
</html>
