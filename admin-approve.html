<!DOCTYPE html>
<html lang="ko">
<head>
     <link rel="stylesheet" href="header_standard.css">
<meta charset="UTF-8">
<title>ê´€ë¦¬ì ìŠ¹ì¸</title>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
<style>
body { background:#0f1015; color:#eee; font-family:system-ui; padding:20px; }
.card { background:#1c1f2a; padding:20px; border-radius:12px; margin-bottom:10px; }
button { margin-left:10px; }
</style>

<style>
/* ğŸ”’ Header profile image standard (force main style) */
header .user-box img {
  width: 32px !important;
  height: 32px !important;
  border-radius: 50% !important;
  object-fit: cover !important;
  border: 1px solid #444 !important;
}
/* ğŸ”’ Logout button standard (prevent green override) */
button.logout {
  background: transparent !important;
  border: 1px solid #555 !important;
  color: #ccc !important;
}
</style>

</head>
<body>
<header>
    <div class="logo" id="appTitle">ROIDER</div>
    <div class="user-box">
      <img id="userPhoto" src="" alt="profile" />
      <span id="userName">Loading...</span>
      <button class="logout" onclick="logout()">Logout</button>
    </div>
  </header>
<h2>ìŠ¹ì¸ ëŒ€ê¸°ì ëª©ë¡</h2>
<div id="list"></div>

<script>
const firebaseConfig = { /* ë™ì¼ */ };
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(async user => {
  if (!user) return location.href = "login.html";
  const me = await db.collection("users").doc(user.uid).get();
  if (me.data().role !== "admin") {
    alert("ê´€ë¦¬ì ì „ìš©");
    return location.href = "main.html";
  }

  db.collection("users").where("role", "==", "pending")
    .onSnapshot(snapshot => {
      const list = document.getElementById("list");
      list.innerHTML = "";
      snapshot.forEach(doc => {
        const u = doc.data();
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `${u.nickname} (${u.email})
          <button onclick="approve('${doc.id}')">ìŠ¹ì¸</button>`;
        list.appendChild(div);
      });
    });
});

function approve(uid) {
  db.collection("users").doc(uid).update({ role: "member" });
}
</script>
</body>
</html>
